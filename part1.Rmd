---
title: "GroupProj1"
author: "Saif"
date: "13-11-2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Import libraries
library(readr)
library(dplyr)
library(ggplot2)
```


## Question 1 
#1a

```{r}
# Load the data

kpData <- read_csv("keyPressDataWithLaneDeviation.csv")
View(kpData)
```

```{r}
# Report Mean, Standard Deviation, and Standard Error of the Mean
# for dualSteerFocus and dualDialFocus
dualSteerData <- subset(kpData, partOfExperiment == 'dualSteerFocus' & typingErrorMadeOnTrial == 0 & phoneNrLengthAfterKeyPress ==11)
dualDialData <- subset(kpData, partOfExperiment == 'dualDialFocus' & typingErrorMadeOnTrial == 0 & phoneNrLengthAfterKeyPress ==11)

View(dualSteerData)

# Average time per participant dualSteer
mds <-mean(aggregate(timeRelativeToTrialStart~pp,dualSteerData,mean)$timeRelativeToTrialStart)
# Std dualSteer
sdds <-sd(aggregate(timeRelativeToTrialStart~pp,dualSteerData,mean)$timeRelativeToTrialStart)
# Standard Error dualSteer
seds <-sd(aggregate(timeRelativeToTrialStart~pp,dualSteerData,mean)$timeRelativeToTrialStart) / sqrt(12)



# Average time per participant dualDial
mdd<-mean(aggregate(timeRelativeToTrialStart~pp,dualDialData,mean)$timeRelativeToTrialStart)
# Std dualDial
sddd<-sd(aggregate(timeRelativeToTrialStart~pp,dualDialData,mean)$timeRelativeToTrialStart)
# Standard Error dualDial
sedd<-sd(aggregate(timeRelativeToTrialStart~pp,dualDialData,mean)$timeRelativeToTrialStart)/ sqrt(12)


table <- matrix(c(mds,sdds,seds,mdd,sddd,sedd),ncol =3, byrow=TRUE)
colnames(table) <-c("M", "SD","SE")
rownames(table) <- c("Steering Focus", "Dialing Focus")
table <- as.data.frame(table)
table
div <- function(x){x/1000}
table <- mutate_each(table, funs(div))
table
```

```{r}
# Question 1b
dualSteerData <- subset(kpData, partOfExperiment == 'dualSteerFocus' & typingErrorMadeOnTrial == 0)
dualDialData <- subset(kpData, partOfExperiment == 'dualDialFocus' & typingErrorMadeOnTrial == 0)

# Mean Lateral Deviation Dual Steer
print("dual Steer Lateral Deviation")
mean(aggregate(abs(lanePosition)~pp,dualSteerData,mean)$'abs(lanePosition)')
# Std Lateral Deviation Dual Steer
sd(aggregate(abs(lanePosition)~pp,dualSteerData,mean)$'abs(lanePosition)')
# Standard Error Lateral Deviation Dual Steer
sd(aggregate(abs(lanePosition)~pp,dualSteerData,mean)$'abs(lanePosition)')/ sqrt(12)

# Mean Lateral Deviation Dual Dial
print("dual Dial Lateral Deviation")
mean(aggregate(abs(lanePosition)~pp,dualDialData,mean)$'abs(lanePosition)')
# Std Lateral Deviation Dual Dial
sd(aggregate(abs(lanePosition)~pp,dualDialData,mean)$'abs(lanePosition)')
# Standard Error Lateral Deviation Dual Dial
sd(aggregate(abs(lanePosition)~pp,dualDialData,mean)$'abs(lanePosition)')/ sqrt(12)

```

```{r}
# Question 1C
# Aggregate averages per participant per digit typed and condition --> average across participants
# Take absolute values of lane deviation
# Use phoneNrLengthAfterKeyPress for absolute lane deviation over time 


# Subset data with only Dial and Steer Data, without errors made on trial


tableData %>%
  subset(partOfExperiment =='dualDialFocus') %>%
  aggregate(by = list(.$phoneNrLengthAfterKeyPress),
          FUN= mean)


aggregate(subset(tableData, partOfExperiment == 'dualDialFocus'),
          by = list(.$phoneNrLengthAfterKeyPress),
          FUN= mean)

tableData
# Relevant data for DialData
dialData <- kpData %>% 
  filter(partOfExperiment =="dualDialFocus" & typingErrorMadeOnTrial == 0)%>%
  select(pp, trial, phoneNrLengthAfterKeyPress, timeRelativeToTrialStart,
         lanePosition, partOfExperiment)

dialData

# Relevant data for SteerData
steerData <- kpData %>% 
  filter(partOfExperiment =="dualSteerFocus" & typingErrorMadeOnTrial == 0)%>%
  select(pp, trial, phoneNrLengthAfterKeyPress, timeRelativeToTrialStart,
         lanePosition, partOfExperiment)

steerData

dialData %>%
  group_by(pp, phoneNrLengthAfterKeyPress) %>%
  summarize(mean_time = mean(timeRelativeToTrialStart, na.rm = TRUE)/1000, 
            mean_deviation = mean(abs(lanePosition)))

steerData %>%
  group_by(pp, phoneNrLengthAfterKeyPress) %>%
  summarize(mean_time = mean(timeRelativeToTrialStart, na.rm = TRUE)/1000, 
            mean_deviation = mean(abs(lanePosition)))



# Subset averages per participant  
averagesPerPP <- kpData %>% 
  filter(typingErrorMadeOnTrial == 0, partOfExperiment == "dualDialFocus" |  # Filter relevant data
           partOfExperiment == "dualSteerFocus")%>%
  select(pp, trial, phoneNrLengthAfterKeyPress, timeRelativeToTrialStart,   # Select relevant cols
         lanePosition, partOfExperiment) %>%
  group_by(pp, phoneNrLengthAfterKeyPress, partOfExperiment) %>%            # Group by by relevant cols
  summarize(mean_time = mean(timeRelativeToTrialStart, na.rm = TRUE)/1000,  # Get mean time and dev
            mean_deviation = mean(abs(lanePosition)))

# Get Overall means to be plotted
averageAveragesPerPP <- averagesPerPP %>%
  group_by(phoneNrLengthAfterKeyPress, partOfExperiment) %>%  # group by relevant cols
  summarize(dialing_time = mean(mean_time),                   # Get overall means (mean over pps)
            lateral_deviation = mean(mean_deviation),
            se = (sd(mean_deviation) / sqrt(length(mean_deviation)))
            )                          


averageAveragesPerPP %>%
  group_by(partOfExperiment) 

tabData

# Plot Data using ggplot2
ggplot(data = averageAveragesPerPP,
       mapping = aes(x = dialing_time, 
                     y = lateral_deviation, 
                     colour = partOfExperiment)) +
        geom_point() +
        geom_line() + 
        geom_errorbar(aes(ymin=lateral_deviation-se,       # Error Bars
                          ymax=lateral_deviation+se), 
                      width = .2) +
        scale_fill_discrete(name = "Legend",labels = c("Dialing Focus", "Steering Focus")) +
        labs(x = "Dialing Time (sec)", y = "Lateral Deviation (m)",
             title = "Dialing Time vs Lateral Deviation") + 
        xlim(0,10) + 
        ylim(0,1.20) + 
        geom_hline(yintercept= 0.8010104) + 
        theme_minimal()


# TO DO: 
# Uitzoeken wat er mis is met de SDs. Vgm wel op de juiste plek gecalculate, 
# Misschien SD / 2? 
# Plot Lane Boundary erin mikken
# Labels netjes maken
# Check hoe veel punten ik er in moet zetten
# Check of de typingErrorMadeOnTrial == 0 moet zijn
# Misschien door 1000 delen later


```

