---
title: "Project 2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggcorrplot)
```

#Basic RSA (1-3)
```{r}
# Read data and create 12 subject with added noise
NeuralResponses <- read.table('NeuralResponses')
set.seed(100)
for (i  in 1:12) {
  nam <- paste("subject", i, sep = "")
  assign(nam, rnorm(9200, 0, 1)+ NeuralResponses)
}

```


```{r}
# RDM for the original NeuralResponses
NeurSpons = as.data.frame(cor(t(NeuralResponses), method = "pearson"))
NeurSpons %>%
  mutate_all(funs(1-.)) %>%
  ggcorrplot() + 
  ggtitle("RDM of Original Neural Responses")


# RDM for subjects
subject1 %>%
  t() %>%
  cor(method = 'pearson') %>%
  as.data.frame() %>%
  mutate_all(funs(1-.)) %>%
  ggcorrplot() + 
  ggtitle("RDM of Subject1")

subject2 %>%
  t() %>%
  cor(method = 'pearson') %>%
  as.data.frame() %>%
  mutate_all(funs(1-.)) %>%
  ggcorrplot() + 
  ggtitle("RDM of Subject2")

subject3 %>%
  t() %>%
  cor(method = 'pearson') %>%
  as.data.frame() %>%
  mutate_all(funs(1-.)) %>%
  ggcorrplot() + 
  ggtitle("RDM of Subject3")

subject4 %>%
  t() %>%
  cor(method = 'pearson') %>%
  as.data.frame() %>%
  mutate_all(funs(1-.)) %>%
  ggcorrplot() + 
  ggtitle("RDM of Subject4")

#### ----- ####

```
```{r}
meanMatrix = (subject1 + subject2 + subject3 + subject4 + subject5+ subject6+
                subject7 + subject8 + subject9 + subject10 + subject11 + subject12) / 12 
meanMatrix %>%
  t() %>%
  cor(method = 'pearson') %>%
  as.data.frame() %>%
  mutate_all(funs(1-.)) %>%
  ggcorrplot() + 
  ggtitle("averaged RDM of all subjects")
```

# Hypothesis Testing (4 - 10)
```{r}
# Binary Classification of of the images 
CategoryVectors <- read.table('CategoryVectors')

# Labels of the categories (12 categories)
CategoryLabels <- read.table('CategoryLabels')


CategoryVectors %>%
  select(1) %>%
  t() %>%
  
  cor(method = 'pearson') %>%
  as.data.frame() %>%
  mutate_all(funs(1-.)) %>%
  ggcorrplot() + 
  ggtitle("RDM of CategoryVectors") 



df1 <- CategoryVectors %>%
  select(1) %>% 
  t() %>% 
  as.data.frame()

df1


animacyMatrix <- function(df) {
  newDf <- data.frame()
  
}

```





# Question 11 --> 
```{r}
NeuroRDM <- read.table('NeuroRDM')

### RMS of NeuroRDM and meanMatrix 

NeuroRDM %>%
  t() %>%
  cor(method = 'pearson') %>%
  as.data.frame() %>%
  mutate_all(funs(1-.)) %>%
  ggcorrplot() + 
  ggtitle("NeuroRDM")

meanMatrix %>%
  t() %>%
  cor(method = 'pearson') %>%
  as.data.frame() %>%
  mutate_all(funs(1-.)) %>%
  ggcorrplot() + 
  ggtitle("averaged RDM of all subjects")

####  Compare two RDMS



```


